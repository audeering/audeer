

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>audeer.core.io &mdash; audeer Documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../../_static/favicon.png"/>
  
  
  

  

  
  
    

  
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/audeering.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/copybutton.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    
  

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          <a href="../../../index.html">
          
            <img src="../../../_static/images/audeering.png" class="logo" alt="audEERING"/>
          
          
            <span> audeer</span>
          
          </a>

          
            
            
              <div class="version">
                v2.2.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../usage.html">Usage</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../api/audeer.html">audeer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../genindex.html">Index</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../changelog.html">Changelog</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">audeer</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../index.html">Module code</a> &raquo;</li>
      <li>audeer.core.io</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for audeer.core.io</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span><span class="w"> </span><span class="nn">__future__</span><span class="w"> </span><span class="kn">import</span> <span class="n">annotations</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">collections.abc</span><span class="w"> </span><span class="kn">import</span> <span class="n">Sequence</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">errno</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">fnmatch</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">hashlib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">inspect</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">io</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">itertools</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">shutil</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tarfile</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">urllib.request</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">zipfile</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">audeer.core.path</span><span class="w"> </span><span class="kn">import</span> <span class="n">path</span> <span class="k">as</span> <span class="n">safe_path</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">audeer.core.tqdm</span><span class="w"> </span><span class="kn">import</span> <span class="n">format_display_message</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">audeer.core.tqdm</span><span class="w"> </span><span class="kn">import</span> <span class="n">progress_bar</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">audeer.core.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">to_list</span>


<div class="viewcode-block" id="basename_wo_ext"><a class="viewcode-back" href="../../../api/audeer.basename_wo_ext.html#audeer.basename_wo_ext">[docs]</a><span class="k">def</span><span class="w"> </span><span class="nf">basename_wo_ext</span><span class="p">(</span>
    <span class="n">path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">bytes</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">ext</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;File basename without file extension.</span>

<span class="sd">    Args:</span>
<span class="sd">        path: file or directory name</span>
<span class="sd">        ext: explicit extension to be removed</span>

<span class="sd">    Returns:</span>
<span class="sd">        basename of directory or file without extension</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; path = &quot;/test/file.wav&quot;</span>
<span class="sd">        &gt;&gt;&gt; audeer.basename_wo_ext(path)</span>
<span class="sd">        &#39;file&#39;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">safe_path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ext</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ext</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">):</span>
            <span class="n">ext</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="n">ext</span>  <span class="c1"># &#39;mp3&#39; =&gt; &#39;.mp3&#39;</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">removesuffix</span><span class="p">(</span><span class="n">ext</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">path</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">path</span></div>


<div class="viewcode-block" id="common_directory"><a class="viewcode-back" href="../../../api/audeer.common_directory.html#audeer.common_directory">[docs]</a><span class="k">def</span><span class="w"> </span><span class="nf">common_directory</span><span class="p">(</span>
    <span class="n">dirs</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">sep</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">sep</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Find common directory path.</span>

<span class="sd">    Args:</span>
<span class="sd">        dirs: list of directories</span>
<span class="sd">        sep: path separator</span>

<span class="sd">    Returns:</span>
<span class="sd">        part of the directory tree that is common to all the directories</span>

<span class="sd">    Examples:</span>
<span class="sd">        .. skip: start if(platform.system() == &quot;Windows&quot;)</span>

<span class="sd">        &gt;&gt;&gt; paths = [</span>
<span class="sd">        ...     &quot;/home/user1/tmp/coverage/test&quot;,</span>
<span class="sd">        ...     &quot;/home/user1/tmp/covert/operator&quot;,</span>
<span class="sd">        ...     &quot;/home/user1/tmp/coven/members&quot;,</span>
<span class="sd">        ... ]</span>
<span class="sd">        &gt;&gt;&gt; audeer.common_directory(paths)</span>
<span class="sd">        &#39;/home/user1/tmp&#39;</span>

<span class="sd">        .. skip: end</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">all_names_equal</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">all</span><span class="p">(</span><span class="n">n</span> <span class="o">==</span> <span class="n">name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">name</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>

    <span class="n">dirs</span> <span class="o">=</span> <span class="p">[</span><span class="n">safe_path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">dirs</span><span class="p">]</span>
    <span class="n">by_directory_levels</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">dirs</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">takewhile</span><span class="p">(</span>
            <span class="n">all_names_equal</span><span class="p">,</span>
            <span class="n">by_directory_levels</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span></div>


<div class="viewcode-block" id="create_archive"><a class="viewcode-back" href="../../../api/audeer.create_archive.html#audeer.create_archive">[docs]</a><span class="k">def</span><span class="w"> </span><span class="nf">create_archive</span><span class="p">(</span>
    <span class="n">root</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">files</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">archive</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Create ZIP or TAR archive.</span>

<span class="sd">    If a list with ``files`` is provided,</span>
<span class="sd">    only those files will be included to the archive.</span>
<span class="sd">    In that case the files are added in the given order,</span>
<span class="sd">    which may have an influence on the checksum of the archive.</span>

<span class="sd">    If ``files`` is set to ``None``,</span>
<span class="sd">    all files below ``root`` will be added in sorted order.</span>
<span class="sd">    This includes hidden files and files from sub-folders,</span>
<span class="sd">    but not empty folders.</span>

<span class="sd">    Args:</span>
<span class="sd">        root: path to root folder of archive.</span>
<span class="sd">            Only files below ``root`` can be included</span>
<span class="sd">            and will be stored relative to ``root``</span>
<span class="sd">        files: files that will be included in the archive.</span>
<span class="sd">            Absolute and relative file paths are possible,</span>
<span class="sd">            as long as the files are below ``root``.</span>
<span class="sd">            If set to ``None``</span>
<span class="sd">            all files below ``root``</span>
<span class="sd">            will be added to the archive</span>
<span class="sd">        archive: path to archive file.</span>
<span class="sd">            The type of the archive</span>
<span class="sd">            is determined from its file extension</span>
<span class="sd">        verbose: if ``True`` a progress bar is shown</span>

<span class="sd">    Raises:</span>
<span class="sd">        FileNotFoundError: if ``root`` or a file in ``files`` is not found</span>
<span class="sd">        NotADirectoryError: if ``root`` is not a directory</span>
<span class="sd">        RuntimeError: if archive does not end with ``zip``,</span>
<span class="sd">            ``tar``, ``tar.gz``, ``tar.bz2``, ``tar.xz``</span>
<span class="sd">        RuntimeError: if a file in ``files`` is not below ``root``</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; file_a = audeer.touch(&quot;a.txt&quot;)</span>
<span class="sd">        &gt;&gt;&gt; folder = os.path.dirname(file_a)</span>
<span class="sd">        &gt;&gt;&gt; file_b = audeer.touch(folder, &quot;b.txt&quot;)</span>
<span class="sd">        &gt;&gt;&gt; archive = audeer.path(&quot;archive.zip&quot;)</span>
<span class="sd">        &gt;&gt;&gt; audeer.create_archive(folder, None, archive)</span>
<span class="sd">        &gt;&gt;&gt; audeer.extract_archive(archive, &quot;.&quot;)</span>
<span class="sd">        [&#39;a.txt&#39;, &#39;b.txt&#39;]</span>
<span class="sd">        &gt;&gt;&gt; archive = audeer.path(&quot;archive.tar.gz&quot;)</span>
<span class="sd">        &gt;&gt;&gt; audeer.create_archive(folder, [&quot;a.txt&quot;], archive)</span>
<span class="sd">        &gt;&gt;&gt; audeer.extract_archive(archive, &quot;.&quot;)</span>
<span class="sd">        [&#39;a.txt&#39;]</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">root</span> <span class="o">=</span> <span class="n">safe_path</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
    <span class="n">archive</span> <span class="o">=</span> <span class="n">safe_path</span><span class="p">(</span><span class="n">archive</span><span class="p">)</span>
    <span class="n">mkdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">archive</span><span class="p">))</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">root</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span>
            <span class="n">errno</span><span class="o">.</span><span class="n">ENOENT</span><span class="p">,</span>
            <span class="n">os</span><span class="o">.</span><span class="n">strerror</span><span class="p">(</span><span class="n">errno</span><span class="o">.</span><span class="n">ENOENT</span><span class="p">),</span>
            <span class="n">root</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">root</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotADirectoryError</span><span class="p">(</span>
            <span class="n">errno</span><span class="o">.</span><span class="n">ENOTDIR</span><span class="p">,</span>
            <span class="n">os</span><span class="o">.</span><span class="n">strerror</span><span class="p">(</span><span class="n">errno</span><span class="o">.</span><span class="n">ENOTDIR</span><span class="p">),</span>
            <span class="n">root</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">files</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">files</span> <span class="o">=</span> <span class="n">list_file_names</span><span class="p">(</span>
            <span class="n">root</span><span class="p">,</span>
            <span class="n">basenames</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">hidden</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">files_org</span> <span class="o">=</span> <span class="n">to_list</span><span class="p">(</span><span class="n">files</span><span class="p">)</span>
        <span class="n">files</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files_org</span><span class="p">:</span>
            <span class="c1"># convert to absolute path</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isabs</span><span class="p">(</span><span class="n">file</span><span class="p">):</span>
                <span class="n">path</span> <span class="o">=</span> <span class="n">safe_path</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">path</span> <span class="o">=</span> <span class="n">safe_path</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

            <span class="c1"># file is below root</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">path</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">root</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Only files below &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">root</span><span class="si">}</span><span class="s2">&#39; &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;can be included. &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;This is not the case with &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
                <span class="p">)</span>

            <span class="c1"># file exists</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span>
                    <span class="n">errno</span><span class="o">.</span><span class="n">ENOENT</span><span class="p">,</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">strerror</span><span class="p">(</span><span class="n">errno</span><span class="o">.</span><span class="n">ENOENT</span><span class="p">),</span>
                    <span class="n">file</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="c1"># convert to relative path</span>
            <span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">path</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:])</span>

    <span class="c1"># Progress bar arguments</span>
    <span class="n">desc</span> <span class="o">=</span> <span class="n">format_display_message</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Create </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">archive</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">pbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">disable</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">verbose</span>

    <span class="n">archive_handlers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;zip&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">path</span><span class="p">:</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZIP_DEFLATED</span><span class="p">),</span>
        <span class="s2">&quot;tar&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">path</span><span class="p">:</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;w:&quot;</span><span class="p">),</span>
        <span class="s2">&quot;tar.gz&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">path</span><span class="p">:</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;w:gz&quot;</span><span class="p">),</span>
        <span class="s2">&quot;tar.bz2&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">path</span><span class="p">:</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;w:bz2&quot;</span><span class="p">),</span>
        <span class="s2">&quot;tar.xz&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">path</span><span class="p">:</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;w:xz&quot;</span><span class="p">),</span>
    <span class="p">}</span>

    <span class="c1"># Get the archive extension</span>
    <span class="n">extension</span> <span class="o">=</span> <span class="nb">next</span><span class="p">((</span><span class="n">ext</span> <span class="k">for</span> <span class="n">ext</span> <span class="ow">in</span> <span class="n">archive_handlers</span> <span class="k">if</span> <span class="n">archive</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">ext</span><span class="p">)),</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">extension</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">supported</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">archive_handlers</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Unsupported archive format. Supported formats: </span><span class="si">{</span><span class="n">supported</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="c1"># Create and populate the archive</span>
    <span class="k">with</span> <span class="n">archive_handlers</span><span class="p">[</span><span class="n">extension</span><span class="p">](</span><span class="n">archive</span><span class="p">)</span> <span class="k">as</span> <span class="n">archive_file</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">progress_bar</span><span class="p">(</span><span class="n">files</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">desc</span><span class="p">,</span> <span class="n">disable</span><span class="o">=</span><span class="n">disable</span><span class="p">):</span>
            <span class="n">full_file</span> <span class="o">=</span> <span class="n">safe_path</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">extension</span> <span class="o">==</span> <span class="s2">&quot;zip&quot;</span><span class="p">:</span>
                <span class="n">archive_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">full_file</span><span class="p">,</span> <span class="n">arcname</span><span class="o">=</span><span class="n">file</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">archive_file</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">full_file</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span></div>


<div class="viewcode-block" id="download_url"><a class="viewcode-back" href="../../../api/audeer.download_url.html#audeer.download_url">[docs]</a><span class="k">def</span><span class="w"> </span><span class="nf">download_url</span><span class="p">(</span>
    <span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">destination</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">force_download</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Download URL to destination.</span>

<span class="sd">    Args:</span>
<span class="sd">        url: URL of file to download</span>
<span class="sd">        destination: file or folder to store file locally</span>
<span class="sd">        force_download: if ``True`` forces the artifact to be downloaded</span>
<span class="sd">            even if it exists locally already</span>
<span class="sd">        verbose: if ``True`` a progress bar is shown</span>

<span class="sd">    Returns:</span>
<span class="sd">        path of locally stored file</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; dst = audeer.download_url(</span>
<span class="sd">        ...     &quot;https://audeering.github.io/audeer/_static/favicon.png&quot;, &quot;.&quot;</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; os.path.basename(dst)</span>
<span class="sd">        &#39;favicon.png&#39;</span>

<span class="sd">    &quot;&quot;&quot;</span>  <span class="c1"># noqa: E501</span>
    <span class="n">destination</span> <span class="o">=</span> <span class="n">safe_path</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">destination</span><span class="p">):</span>
        <span class="n">destination</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">destination</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">url</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">force_download</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">destination</span>

    <span class="k">with</span> <span class="n">progress_bar</span><span class="p">(</span>
        <span class="n">disable</span><span class="o">=</span><span class="ow">not</span> <span class="n">verbose</span><span class="p">,</span>
        <span class="n">desc</span><span class="o">=</span><span class="n">format_display_message</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Downloading </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">pbar</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="p">)</span> <span class="k">as</span> <span class="n">pbar</span><span class="p">:</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">bar_update</span><span class="p">(</span><span class="n">block_num</span><span class="p">,</span> <span class="n">block_size</span><span class="p">,</span> <span class="n">total_size</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">pbar</span><span class="o">.</span><span class="n">total</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">total_size</span><span class="p">:</span>
                <span class="n">pbar</span><span class="o">.</span><span class="n">total</span> <span class="o">=</span> <span class="n">total_size</span>
            <span class="n">pbar</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">block_size</span><span class="p">)</span>

        <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">destination</span><span class="p">,</span> <span class="n">reporthook</span><span class="o">=</span><span class="n">bar_update</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">destination</span></div>


<div class="viewcode-block" id="extract_archive"><a class="viewcode-back" href="../../../api/audeer.extract_archive.html#audeer.extract_archive">[docs]</a><span class="k">def</span><span class="w"> </span><span class="nf">extract_archive</span><span class="p">(</span>
    <span class="n">archive</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">destination</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">keep_archive</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Extract ZIP or TAR file.</span>

<span class="sd">    Args:</span>
<span class="sd">        archive: path to ZIP or TAR file</span>
<span class="sd">        destination: folder where the files will be extracted.</span>
<span class="sd">            If the folder does not exists,</span>
<span class="sd">            it will be created</span>
<span class="sd">        keep_archive: if ``False`` delete archive file after extraction</span>
<span class="sd">        verbose: if ``True`` a progress bar is shown</span>

<span class="sd">    Returns:</span>
<span class="sd">        paths of extracted files relative to ``destination``</span>
<span class="sd">        in order they were added to the archive</span>

<span class="sd">    Raises:</span>
<span class="sd">        FileNotFoundError: if ``archive`` is not found</span>
<span class="sd">        IsADirectoryError: if ``archive`` is a directory</span>
<span class="sd">        NotADirectoryError: if ``destination`` is not a directory</span>
<span class="sd">        RuntimeError: if ``archive`` is not a ZIP or TAR file</span>
<span class="sd">        RuntimeError: if ``archive`` is malformed</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; folder = audeer.path(&quot;.&quot;)</span>
<span class="sd">        &gt;&gt;&gt; file = audeer.touch(folder, &quot;a.txt&quot;)</span>
<span class="sd">        &gt;&gt;&gt; archive = audeer.path(&quot;archive.zip&quot;)</span>
<span class="sd">        &gt;&gt;&gt; audeer.create_archive(folder, None, archive)</span>
<span class="sd">        &gt;&gt;&gt; audeer.extract_archive(archive, &quot;.&quot;)</span>
<span class="sd">        [&#39;a.txt&#39;]</span>
<span class="sd">        &gt;&gt;&gt; audeer.extract_archive(archive, &quot;sub&quot;)</span>
<span class="sd">        [&#39;a.txt&#39;]</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">archive</span> <span class="o">=</span> <span class="n">safe_path</span><span class="p">(</span><span class="n">archive</span><span class="p">)</span>
    <span class="n">destination</span> <span class="o">=</span> <span class="n">safe_path</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">archive</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span>
            <span class="n">errno</span><span class="o">.</span><span class="n">ENOENT</span><span class="p">,</span>
            <span class="n">os</span><span class="o">.</span><span class="n">strerror</span><span class="p">(</span><span class="n">errno</span><span class="o">.</span><span class="n">ENOENT</span><span class="p">),</span>
            <span class="n">archive</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">archive</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">IsADirectoryError</span><span class="p">(</span>
            <span class="n">errno</span><span class="o">.</span><span class="n">EISDIR</span><span class="p">,</span>
            <span class="n">os</span><span class="o">.</span><span class="n">strerror</span><span class="p">(</span><span class="n">errno</span><span class="o">.</span><span class="n">EISDIR</span><span class="p">),</span>
            <span class="n">archive</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">destination</span><span class="p">):</span>
        <span class="n">destination_created</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">mkdir</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span>
        <span class="n">destination_created</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">destination</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotADirectoryError</span><span class="p">(</span>
            <span class="n">errno</span><span class="o">.</span><span class="n">ENOTDIR</span><span class="p">,</span>
            <span class="n">os</span><span class="o">.</span><span class="n">strerror</span><span class="p">(</span><span class="n">errno</span><span class="o">.</span><span class="n">ENOTDIR</span><span class="p">),</span>
            <span class="n">destination</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1"># Progress bar arguments</span>
    <span class="n">desc</span> <span class="o">=</span> <span class="n">format_display_message</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Extract </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">archive</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">pbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">disable</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">verbose</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">extract_zip</span><span class="p">(</span><span class="n">archive</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">archive</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">zf</span><span class="p">:</span>
            <span class="n">members</span> <span class="o">=</span> <span class="n">zf</span><span class="o">.</span><span class="n">infolist</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">member</span> <span class="ow">in</span> <span class="n">progress_bar</span><span class="p">(</span><span class="n">members</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">desc</span><span class="p">,</span> <span class="n">disable</span><span class="o">=</span><span class="n">disable</span><span class="p">):</span>
                <span class="n">zf</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">member</span><span class="p">,</span> <span class="n">destination</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">m</span><span class="o">.</span><span class="n">filename</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">members</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">extract_tar</span><span class="p">(</span><span class="n">archive</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">archive</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">tf</span><span class="p">:</span>
            <span class="n">members</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">getmembers</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">member</span> <span class="ow">in</span> <span class="n">progress_bar</span><span class="p">(</span><span class="n">members</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">desc</span><span class="p">,</span> <span class="n">disable</span><span class="o">=</span><span class="n">disable</span><span class="p">):</span>
                <span class="c1"># In Python 3.12 the `filter` argument was introduced,</span>
                <span class="c1"># and it will be set automatically in Python 3.14,</span>
                <span class="c1"># see</span>
                <span class="c1"># https://docs.python.org/3.12/library/tarfile.html#tarfile-extraction-filter</span>
                <span class="c1"># noqa: E501</span>
                <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;numeric_owner&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
                <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">12</span><span class="p">):</span>  <span class="c1"># pragma: no cover</span>
                    <span class="n">kwargs</span> <span class="o">=</span> <span class="n">kwargs</span> <span class="o">|</span> <span class="p">{</span><span class="s2">&quot;filter&quot;</span><span class="p">:</span> <span class="s2">&quot;tar&quot;</span><span class="p">}</span>
                <span class="n">tf</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">member</span><span class="p">,</span> <span class="n">destination</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">m</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">members</span><span class="p">]</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">archive</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;zip&quot;</span><span class="p">):</span>
            <span class="n">files</span> <span class="o">=</span> <span class="n">extract_zip</span><span class="p">(</span><span class="n">archive</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">is_tarfile</span><span class="p">(</span><span class="n">archive</span><span class="p">):</span>
            <span class="n">files</span> <span class="o">=</span> <span class="n">extract_tar</span><span class="p">(</span><span class="n">archive</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;You can only extract ZIP and TAR files, not </span><span class="si">{</span><span class="n">archive</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="p">(</span><span class="ne">EOFError</span><span class="p">,</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">BadZipFile</span><span class="p">,</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">ReadError</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Broken archive: </span><span class="si">{</span><span class="n">archive</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="p">(</span><span class="ne">KeyboardInterrupt</span><span class="p">,</span> <span class="ne">Exception</span><span class="p">):</span>  <span class="c1"># pragma: no cover</span>
        <span class="c1"># Clean up broken extraction files</span>
        <span class="k">if</span> <span class="n">destination_created</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">destination</span><span class="p">):</span>
                <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span>
        <span class="k">raise</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">keep_archive</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">archive</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;nt&quot;</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
        <span class="c1"># replace &#39;/&#39; with &#39;\&#39; on Windows</span>
        <span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="n">file</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">sep</span><span class="p">)</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">files</span></div>


<div class="viewcode-block" id="extract_archives"><a class="viewcode-back" href="../../../api/audeer.extract_archives.html#audeer.extract_archives">[docs]</a><span class="k">def</span><span class="w"> </span><span class="nf">extract_archives</span><span class="p">(</span>
    <span class="n">archives</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">destination</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">keep_archive</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Extract multiple ZIP or TAR archives at once.</span>

<span class="sd">    Args:</span>
<span class="sd">        archives: paths of ZIP or TAR files</span>
<span class="sd">        destination: folder where the files will be extracted.</span>
<span class="sd">            If the folder does not exists,</span>
<span class="sd">            it will be created</span>
<span class="sd">        keep_archive: if ``False`` delete archive files after extraction</span>
<span class="sd">        verbose: if ``True`` a progress bar is shown</span>

<span class="sd">    Returns:</span>
<span class="sd">        paths of extracted files relative to ``destination``</span>
<span class="sd">        in order they were added to the archives</span>

<span class="sd">    Raises:</span>
<span class="sd">        FileNotFoundError: if an archive is not found</span>
<span class="sd">        IsADirectoryError: if an archive is a directory</span>
<span class="sd">        NotADirectoryError: if ``destination`` is not a directory</span>
<span class="sd">        RuntimeError: if an archive is not a ZIP or TAR file</span>
<span class="sd">        RuntimeError: if an archive file is malformed</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; folder = audeer.path(&quot;.&quot;)</span>
<span class="sd">        &gt;&gt;&gt; _ = audeer.touch(folder, &quot;a.txt&quot;)</span>
<span class="sd">        &gt;&gt;&gt; _ = audeer.touch(folder, &quot;b.txt&quot;)</span>
<span class="sd">        &gt;&gt;&gt; archive_a = audeer.path(&quot;archive.zip&quot;)</span>
<span class="sd">        &gt;&gt;&gt; archive_b = audeer.path(&quot;archive.tar.gz&quot;)</span>
<span class="sd">        &gt;&gt;&gt; audeer.create_archive(folder, [&quot;a.txt&quot;], archive_a)</span>
<span class="sd">        &gt;&gt;&gt; audeer.create_archive(folder, [&quot;b.txt&quot;], archive_b)</span>
<span class="sd">        &gt;&gt;&gt; audeer.extract_archives([archive_a, archive_b], &quot;.&quot;)</span>
<span class="sd">        [&#39;a.txt&#39;, &#39;b.txt&#39;]</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="n">progress_bar</span><span class="p">(</span>
        <span class="n">total</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">archives</span><span class="p">),</span>
        <span class="n">disable</span><span class="o">=</span><span class="ow">not</span> <span class="n">verbose</span><span class="p">,</span>
    <span class="p">)</span> <span class="k">as</span> <span class="n">pbar</span><span class="p">:</span>
        <span class="n">member_names</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">archive</span> <span class="ow">in</span> <span class="n">archives</span><span class="p">:</span>
            <span class="n">desc</span> <span class="o">=</span> <span class="n">format_display_message</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Extract </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">archive</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">pbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">pbar</span><span class="o">.</span><span class="n">set_description_str</span><span class="p">(</span><span class="n">desc</span><span class="p">)</span>
            <span class="n">pbar</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
            <span class="n">member_names</span> <span class="o">+=</span> <span class="n">extract_archive</span><span class="p">(</span>
                <span class="n">archive</span><span class="p">,</span>
                <span class="n">destination</span><span class="p">,</span>
                <span class="n">keep_archive</span><span class="o">=</span><span class="n">keep_archive</span><span class="p">,</span>
                <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">pbar</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">member_names</span></div>


<div class="viewcode-block" id="file_extension"><a class="viewcode-back" href="../../../api/audeer.file_extension.html#audeer.file_extension">[docs]</a><span class="k">def</span><span class="w"> </span><span class="nf">file_extension</span><span class="p">(</span>
    <span class="n">path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">bytes</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;File extension.</span>

<span class="sd">    Args:</span>
<span class="sd">        path: path to file</span>

<span class="sd">    Returns:</span>
<span class="sd">        extension of file without &quot;.&quot;</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; path = &quot;/test/file.wav&quot;</span>
<span class="sd">        &gt;&gt;&gt; audeer.file_extension(path)</span>
<span class="sd">        &#39;wav&#39;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">safe_path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">path</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span></div>


<div class="viewcode-block" id="list_dir_names"><a class="viewcode-back" href="../../../api/audeer.list_dir_names.html#audeer.list_dir_names">[docs]</a><span class="k">def</span><span class="w"> </span><span class="nf">list_dir_names</span><span class="p">(</span>
    <span class="n">path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">bytes</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">basenames</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">recursive</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">hidden</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;List of folder names located inside provided path.</span>

<span class="sd">    Args:</span>
<span class="sd">        path: path to directory</span>
<span class="sd">        basenames: if ``True`` return relative path in respect to ``path``</span>
<span class="sd">        recursive: if ``True`` includes subdirectories</span>
<span class="sd">        hidden: if ``True`` includes directories starting with a dot (``.``)</span>

<span class="sd">    Returns:</span>
<span class="sd">        list of paths to directories</span>

<span class="sd">    Raises:</span>
<span class="sd">        NotADirectoryError: if path is not a directory</span>
<span class="sd">        FileNotFoundError: if path does not exists</span>

<span class="sd">    Examples:</span>
<span class="sd">        .. skip: start if(platform.system() == &quot;Windows&quot;)</span>

<span class="sd">        &gt;&gt;&gt; path = audeer.path(&quot;path&quot;)</span>
<span class="sd">        &gt;&gt;&gt; _ = mkdir(path, &quot;a&quot;, &quot;.b&quot;, &quot;c&quot;)</span>
<span class="sd">        &gt;&gt;&gt; audeer.list_dir_names(path, basenames=True)</span>
<span class="sd">        [&#39;a&#39;]</span>
<span class="sd">        &gt;&gt;&gt; audeer.list_dir_names(path, basenames=True, recursive=True)</span>
<span class="sd">        [&#39;a&#39;, &#39;a/.b&#39;, &#39;a/.b/c&#39;]</span>
<span class="sd">        &gt;&gt;&gt; audeer.list_dir_names(path, basenames=True, recursive=True, hidden=False)</span>
<span class="sd">        [&#39;a&#39;]</span>

<span class="sd">        .. skip: end</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">safe_path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">helper</span><span class="p">(</span><span class="n">p</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">paths</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span>
        <span class="n">ps</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">p</span><span class="p">)]</span>
        <span class="n">ps</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ps</span> <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">hidden</span><span class="p">:</span>
            <span class="n">ps</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ps</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)]</span>
        <span class="n">paths</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">ps</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ps</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">recursive</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">ps</span><span class="p">:</span>
                <span class="n">helper</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">paths</span><span class="p">)</span>

    <span class="n">paths</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">helper</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">paths</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">basenames</span><span class="p">:</span>
        <span class="n">paths</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">paths</span><span class="p">]</span>

    <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">paths</span><span class="p">)</span></div>


<div class="viewcode-block" id="list_file_names"><a class="viewcode-back" href="../../../api/audeer.list_file_names.html#audeer.list_file_names">[docs]</a><span class="k">def</span><span class="w"> </span><span class="nf">list_file_names</span><span class="p">(</span>
    <span class="n">path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">bytes</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">filetype</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">basenames</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">recursive</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">hidden</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;List of file names inferred from provided path.</span>

<span class="sd">    Args:</span>
<span class="sd">        path: path to directory,</span>
<span class="sd">            or path to directory plus file matching pattern,</span>
<span class="sd">            e.g. ``&#39;dir/file.txt&#39;``.</span>
<span class="sd">            If ``recursive`` is ``True``</span>
<span class="sd">            returns all files named ``file.txt``</span>
<span class="sd">            from all sub-folders.</span>
<span class="sd">            Besides the filename ``*``, ``?``, ``[seq]``,</span>
<span class="sd">            and ``[!seq]`` can be used as pattern,</span>
<span class="sd">            compare :mod:`fnmatch`</span>
<span class="sd">        filetype: optional consider only this filetype</span>
<span class="sd">        basenames: if ``True`` return relative path in respect to ``path``</span>
<span class="sd">        recursive: if ``True`` includes subdirectories</span>
<span class="sd">        hidden: if ``True`` includes files starting with a dot (``.``)</span>

<span class="sd">    Returns:</span>
<span class="sd">        alphabetically sorted list of path(s) to file(s)</span>

<span class="sd">    Raises:</span>
<span class="sd">        NotADirectoryError: if ``path`` is a directory or file</span>
<span class="sd">            that does not exist,</span>
<span class="sd">            or ``path`` is a pattern</span>
<span class="sd">            and ``os.dirname(path)`` does not exist</span>

<span class="sd">    Examples:</span>
<span class="sd">        .. skip: start if(platform.system() == &quot;Windows&quot;)</span>

<span class="sd">        &gt;&gt;&gt; dir_path = audeer.mkdir(&quot;path&quot;)</span>
<span class="sd">        &gt;&gt;&gt; _ = audeer.touch(dir_path, &quot;file.wav&quot;)</span>
<span class="sd">        &gt;&gt;&gt; _ = audeer.touch(dir_path, &quot;album.wav&quot;)</span>
<span class="sd">        &gt;&gt;&gt; _ = audeer.touch(dir_path, &quot;.lock&quot;)</span>
<span class="sd">        &gt;&gt;&gt; sub_dir_path = audeer.mkdir(dir_path, &quot;sub&quot;)</span>
<span class="sd">        &gt;&gt;&gt; _ = audeer.touch(sub_dir_path, &quot;file.ogg&quot;)</span>
<span class="sd">        &gt;&gt;&gt; _ = audeer.touch(sub_dir_path, &quot;.lock&quot;)</span>
<span class="sd">        &gt;&gt;&gt; audeer.list_file_names(dir_path, basenames=True)</span>
<span class="sd">        [&#39;album.wav&#39;, &#39;file.wav&#39;]</span>
<span class="sd">        &gt;&gt;&gt; audeer.list_file_names(dir_path, basenames=True, hidden=True)</span>
<span class="sd">        [&#39;.lock&#39;, &#39;album.wav&#39;, &#39;file.wav&#39;]</span>
<span class="sd">        &gt;&gt;&gt; audeer.list_file_names(dir_path, basenames=True, recursive=True)</span>
<span class="sd">        [&#39;album.wav&#39;, &#39;file.wav&#39;, &#39;sub/file.ogg&#39;]</span>
<span class="sd">        &gt;&gt;&gt; audeer.list_file_names(dir_path, basenames=True, recursive=True, hidden=True)</span>
<span class="sd">        [&#39;.lock&#39;, &#39;album.wav&#39;, &#39;file.wav&#39;, &#39;sub/.lock&#39;, &#39;sub/file.ogg&#39;]</span>
<span class="sd">        &gt;&gt;&gt; audeer.list_file_names(</span>
<span class="sd">        ...     os.path.join(dir_path, &quot;f*&quot;), basenames=True, recursive=True</span>
<span class="sd">        ... )</span>
<span class="sd">        [&#39;file.wav&#39;, &#39;sub/file.ogg&#39;]</span>
<span class="sd">        &gt;&gt;&gt; audeer.list_file_names(</span>
<span class="sd">        ...     os.path.join(dir_path, &quot;[fa]*&quot;), basenames=True, recursive=True</span>
<span class="sd">        ... )</span>
<span class="sd">        [&#39;album.wav&#39;, &#39;file.wav&#39;, &#39;sub/file.ogg&#39;]</span>
<span class="sd">        &gt;&gt;&gt; audeer.list_file_names(</span>
<span class="sd">        ...     os.path.join(dir_path, &quot;[!f]*&quot;), basenames=True, recursive=True</span>
<span class="sd">        ... )</span>
<span class="sd">        [&#39;album.wav&#39;]</span>
<span class="sd">        &gt;&gt;&gt; audeer.list_file_names(dir_path, filetype=&quot;ogg&quot;, basenames=True, recursive=True)</span>
<span class="sd">        [&#39;sub/file.ogg&#39;]</span>

<span class="sd">        .. skip: end</span>

<span class="sd">    &quot;&quot;&quot;</span>  <span class="c1"># noqa: E501</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">safe_path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
        <span class="n">pattern</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">folder</span> <span class="o">=</span> <span class="n">path</span>

    <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">recursive</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">hidden</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">basenames</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">path</span><span class="p">]</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">pattern</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="n">folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">folder</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">NotADirectoryError</span><span class="p">(</span><span class="n">folder</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">helper</span><span class="p">(</span><span class="n">p</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">paths</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span>
        <span class="n">ps</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">p</span><span class="p">)]</span>
        <span class="n">folders</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ps</span> <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
        <span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ps</span> <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
        <span class="k">if</span> <span class="n">pattern</span><span class="p">:</span>
            <span class="n">files</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">file</span>
                <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span>
                <span class="k">if</span> <span class="n">fnmatch</span><span class="o">.</span><span class="n">fnmatch</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">file</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">pattern</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="p">]</span>
        <span class="k">if</span> <span class="n">filetype</span><span class="p">:</span>
            <span class="n">files</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">file</span>
                <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span>
                <span class="k">if</span> <span class="n">fnmatch</span><span class="o">.</span><span class="n">fnmatch</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">file</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;*</span><span class="si">{</span><span class="n">filetype</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="p">]</span>
        <span class="n">paths</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">files</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">folders</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">recursive</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">folders</span><span class="p">:</span>
                <span class="n">helper</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">paths</span><span class="p">)</span>

    <span class="n">paths</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">helper</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">paths</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">is_pattern</span><span class="p">(</span><span class="n">pattern</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;*&quot;</span> <span class="ow">in</span> <span class="n">pattern</span> <span class="ow">or</span> <span class="s2">&quot;?&quot;</span> <span class="ow">in</span> <span class="n">pattern</span> <span class="ow">or</span> <span class="p">(</span><span class="s2">&quot;[&quot;</span> <span class="ow">in</span> <span class="n">pattern</span> <span class="ow">and</span> <span class="s2">&quot;]&quot;</span> <span class="ow">in</span> <span class="n">pattern</span><span class="p">)</span>

    <span class="c1"># if we have no match,</span>
    <span class="c1"># raise an error unless</span>
    <span class="c1"># 1. path is a folder (i.e. pattern is None)</span>
    <span class="c1"># 2. or we have a valid pattern</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">paths</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">pattern</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">is_pattern</span><span class="p">(</span><span class="n">pattern</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotADirectoryError</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">hidden</span><span class="p">:</span>
        <span class="n">paths</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">paths</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)]</span>

    <span class="k">if</span> <span class="n">basenames</span><span class="p">:</span>
        <span class="n">paths</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">folder</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">paths</span><span class="p">]</span>

    <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">paths</span><span class="p">)</span></div>


<div class="viewcode-block" id="mkdir"><a class="viewcode-back" href="../../../api/audeer.mkdir.html#audeer.mkdir">[docs]</a><span class="k">def</span><span class="w"> </span><span class="nf">mkdir</span><span class="p">(</span>
    <span class="n">path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">bytes</span><span class="p">,</span>
    <span class="o">*</span><span class="n">paths</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="nb">bytes</span><span class="p">],</span>
    <span class="n">mode</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mo">0o777</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create directory.</span>

<span class="sd">    Create a directory at the provided path</span>
<span class="sd">    and return the absolute path to the generated directory.</span>
<span class="sd">    If parent directories are missing,</span>
<span class="sd">    they are created as well.</span>
<span class="sd">    If the directory exists already,</span>
<span class="sd">    only its absolute path is returned.</span>

<span class="sd">    On some systems, mode is ignored.</span>
<span class="sd">    Where it is used, the current umask value is first masked out.</span>
<span class="sd">    If bits other than the last 9</span>
<span class="sd">    (i.e. the last 3 digits of the octal representation of the mode)</span>
<span class="sd">    are set,</span>
<span class="sd">    their meaning is platform-dependent.</span>
<span class="sd">    On some platforms, they are ignored</span>
<span class="sd">    and you should call :func:`os.chmod`</span>
<span class="sd">    explicitly to set them.</span>

<span class="sd">    Args:</span>
<span class="sd">        path: absolute or relative path of directory to create</span>
<span class="sd">        *paths: additional arguments</span>
<span class="sd">            to be joined with ``path``</span>
<span class="sd">            by :func:`os.path.join`</span>
<span class="sd">        mode: set permissions of created folders</span>

<span class="sd">    Returns:</span>
<span class="sd">        absolute path to the created directory</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; path = audeer.mkdir(&quot;path1&quot;, &quot;path2&quot;, &quot;path3&quot;)</span>
<span class="sd">        &gt;&gt;&gt; os.path.basename(path)</span>
<span class="sd">        &#39;path3&#39;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">safe_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="o">*</span><span class="n">paths</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">path</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">path</span></div>


<div class="viewcode-block" id="md5"><a class="viewcode-back" href="../../../api/audeer.md5.html#audeer.md5">[docs]</a><span class="k">def</span><span class="w"> </span><span class="nf">md5</span><span class="p">(</span>
    <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">chunk_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8192</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate MD5 checksum of file or folder.</span>

<span class="sd">    If ``path`` is a folder,</span>
<span class="sd">    the checksum is calculated</span>
<span class="sd">    from all files in the folder</span>
<span class="sd">    (including hidden files).</span>
<span class="sd">    The checksum also encodes</span>
<span class="sd">    the (relative) file names,</span>
<span class="sd">    so that renaming files</span>
<span class="sd">    results in a different checksum.</span>
<span class="sd">    However,</span>
<span class="sd">    the calculation is independent of</span>
<span class="sd">    file separator of the operation systems.</span>
<span class="sd">    Empty folders are ignored.</span>

<span class="sd">    Args:</span>
<span class="sd">        path: path to file or folder</span>
<span class="sd">        chunk_size: chunk size in number of bytes</span>

<span class="sd">    Returns:</span>
<span class="sd">        checksum</span>

<span class="sd">    Raises:</span>
<span class="sd">        FileNotFoundError: if ``path`` does not exist</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; path = audeer.touch(&quot;file.txt&quot;)</span>
<span class="sd">        &gt;&gt;&gt; audeer.md5(path)</span>
<span class="sd">        &#39;d41d8cd98f00b204e9800998ecf8427e&#39;</span>
<span class="sd">        &gt;&gt;&gt; audeer.md5(os.path.dirname(path))</span>
<span class="sd">        &#39;3d8e577bddb17db339eae0b3d9bcf180&#39;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">safe_path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="n">hasher</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">()</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span>
            <span class="n">errno</span><span class="o">.</span><span class="n">ENOENT</span><span class="p">,</span>
            <span class="n">os</span><span class="o">.</span><span class="n">strerror</span><span class="p">(</span><span class="n">errno</span><span class="o">.</span><span class="n">ENOENT</span><span class="p">),</span>
            <span class="n">path</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">md5_read_chunk</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">chunk_size</span><span class="p">):</span>
                <span class="n">hasher</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">files</span> <span class="o">=</span> <span class="n">list_file_names</span><span class="p">(</span>
            <span class="n">path</span><span class="p">,</span>
            <span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">hidden</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">basenames</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
            <span class="c1"># encode file name that renaming of files</span>
            <span class="c1"># produces different checksum</span>
            <span class="n">hasher</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">sep</span><span class="p">,</span> <span class="s2">&quot;/&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">safe_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">file</span><span class="p">),</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">md5_read_chunk</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">chunk_size</span><span class="p">):</span>
                    <span class="n">hasher</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">hasher</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span></div>


<span class="k">def</span><span class="w"> </span><span class="nf">md5_read_chunk</span><span class="p">(</span>
    <span class="n">fp</span><span class="p">:</span> <span class="n">io</span><span class="o">.</span><span class="n">IOBase</span><span class="p">,</span>
    <span class="n">chunk_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8192</span><span class="p">,</span>
<span class="p">):</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">chunk_size</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="k">yield</span> <span class="n">data</span>


<div class="viewcode-block" id="move"><a class="viewcode-back" href="../../../api/audeer.move.html#audeer.move">[docs]</a><span class="k">def</span><span class="w"> </span><span class="nf">move</span><span class="p">(</span>
    <span class="n">src_path</span><span class="p">,</span>
    <span class="n">dst_path</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Move a file or folder independent of operating system.</span>

<span class="sd">    As :func:`os.rename` works differently</span>
<span class="sd">    under Unix and Windows</span>
<span class="sd">    and :func:`shutil.move` can be slow,</span>
<span class="sd">    we use :func:`os.replace`</span>
<span class="sd">    to move the file/folder.</span>

<span class="sd">    Args:</span>
<span class="sd">        src_path: source file/folder path</span>
<span class="sd">        dst_path: destination file/folder path</span>

<span class="sd">    Raises:</span>
<span class="sd">        OSError: if ``src_path`` is a file</span>
<span class="sd">            and ``dst_path`` is an existing folder</span>
<span class="sd">        OSError: if ``src_path`` is a folder</span>
<span class="sd">            and ``dst_path`` is an existing file</span>
<span class="sd">            (not raised under Windows)</span>
<span class="sd">        OSError: if ``dst_path`` is a non-empty folder,</span>
<span class="sd">            different from ``src_path``,</span>
<span class="sd">            and ``src_path`` is also a folder</span>
<span class="sd">        OSError: if ``dst_path`` is an empty folder,</span>
<span class="sd">            different from ``src_path``</span>
<span class="sd">            and ``src_path`` is also a folder</span>
<span class="sd">            (raised only under Windows)</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; path = audeer.mkdir(&quot;folder&quot;)</span>
<span class="sd">        &gt;&gt;&gt; src_path = audeer.touch(path, &quot;file1&quot;)</span>
<span class="sd">        &gt;&gt;&gt; dst_path = os.path.join(path, &quot;file2&quot;)</span>
<span class="sd">        &gt;&gt;&gt; audeer.move(src_path, dst_path)</span>
<span class="sd">        &gt;&gt;&gt; audeer.list_file_names(path, basenames=True)</span>
<span class="sd">        [&#39;file2&#39;]</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">os</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">src_path</span><span class="p">,</span> <span class="n">dst_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="move_file"><a class="viewcode-back" href="../../../api/audeer.move_file.html#audeer.move_file">[docs]</a><span class="k">def</span><span class="w"> </span><span class="nf">move_file</span><span class="p">(</span>
    <span class="n">src_path</span><span class="p">,</span>
    <span class="n">dst_path</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Move a file independent of operating system.</span>

<span class="sd">    As :func:`os.rename` works differently</span>
<span class="sd">    under Unix and Windows</span>
<span class="sd">    and :func:`shutil.move` can be slow,</span>
<span class="sd">    we use :func:`os.replace`</span>
<span class="sd">    to move the file.</span>

<span class="sd">    Warning:</span>
<span class="sd">        :func:`audeer.move_file` is deprecated,</span>
<span class="sd">        please use :func:`audeer.move` instead.</span>

<span class="sd">    Args:</span>
<span class="sd">        src_path: source file path</span>
<span class="sd">        dst_path: destination file path</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; path = audeer.mkdir(&quot;folder&quot;)</span>
<span class="sd">        &gt;&gt;&gt; src_path = audeer.touch(path, &quot;file1&quot;)</span>
<span class="sd">        &gt;&gt;&gt; dst_path = os.path.join(path, &quot;file2&quot;)</span>
<span class="sd">        &gt;&gt;&gt; audeer.move_file(src_path, dst_path)</span>
<span class="sd">        &gt;&gt;&gt; audeer.list_file_names(path, basenames=True)</span>
<span class="sd">        [&#39;file2&#39;]</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">move</span><span class="p">(</span><span class="n">src_path</span><span class="p">,</span> <span class="n">dst_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="replace_file_extension"><a class="viewcode-back" href="../../../api/audeer.replace_file_extension.html#audeer.replace_file_extension">[docs]</a><span class="k">def</span><span class="w"> </span><span class="nf">replace_file_extension</span><span class="p">(</span>
    <span class="n">path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">bytes</span><span class="p">,</span>
    <span class="n">new_extension</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">ext</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Replace file extension.</span>

<span class="sd">    If ``ext`` is ``None``</span>
<span class="sd">    it uses :func:`audeer.file_extension`</span>
<span class="sd">    to identify the current extension</span>
<span class="sd">    and replaces it with ``new_extension``.</span>

<span class="sd">    If ``ext`` is not ``None``</span>
<span class="sd">    but ``path`` ends on a different extension,</span>
<span class="sd">    the original path is returned.</span>

<span class="sd">    Args:</span>
<span class="sd">        path: path to file</span>
<span class="sd">        new_extension: new file extension</span>
<span class="sd">        ext: explicit extension to be removed</span>

<span class="sd">    Returns:</span>
<span class="sd">        path to file with a possibly new extension</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; audeer.replace_file_extension(&quot;file.txt&quot;, &quot;rst&quot;)</span>
<span class="sd">        &#39;file.rst&#39;</span>
<span class="sd">        &gt;&gt;&gt; audeer.replace_file_extension(&quot;file&quot;, &quot;rst&quot;)</span>
<span class="sd">        &#39;file.rst&#39;</span>
<span class="sd">        &gt;&gt;&gt; audeer.replace_file_extension(&quot;file.txt&quot;, &quot;&quot;)</span>
<span class="sd">        &#39;file&#39;</span>
<span class="sd">        &gt;&gt;&gt; audeer.replace_file_extension(&quot;file.tar.gz&quot;, &quot;zip&quot;, ext=&quot;tar.gz&quot;)</span>
<span class="sd">        &#39;file.zip&#39;</span>
<span class="sd">        &gt;&gt;&gt; audeer.replace_file_extension(&quot;file.zip&quot;, &quot;rst&quot;, ext=&quot;txt&quot;)</span>
<span class="sd">        &#39;file.zip&#39;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">ext</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ext</span> <span class="o">=</span> <span class="n">file_extension</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

    <span class="c1"># &#39;.mp3&#39; =&gt; &#39;mp3&#39;</span>
    <span class="n">ext</span> <span class="o">=</span> <span class="n">ext</span><span class="o">.</span><span class="n">removeprefix</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
    <span class="n">new_extension</span> <span class="o">=</span> <span class="n">new_extension</span><span class="o">.</span><span class="n">removeprefix</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">ext</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;.</span><span class="si">{</span><span class="n">ext</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">path</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">path</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">path</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">ext</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">new_extension</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="n">ext</span><span class="p">:</span>
        <span class="n">path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">new_extension</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="n">new_extension</span><span class="p">:</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">path</span><span class="p">[:</span> <span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">ext</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">path</span><span class="p">[:</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">ext</span><span class="p">)]</span><span class="si">}{</span><span class="n">new_extension</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">return</span> <span class="n">path</span></div>


<div class="viewcode-block" id="rmdir"><a class="viewcode-back" href="../../../api/audeer.rmdir.html#audeer.rmdir">[docs]</a><span class="k">def</span><span class="w"> </span><span class="nf">rmdir</span><span class="p">(</span>
    <span class="n">path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">bytes</span><span class="p">,</span>
    <span class="o">*</span><span class="n">paths</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="nb">bytes</span><span class="p">],</span>
    <span class="n">follow_symlink</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Remove directory.</span>

<span class="sd">    Remove the directory</span>
<span class="sd">    and all its content</span>
<span class="sd">    if the directory exists.</span>

<span class="sd">    Args:</span>
<span class="sd">        path: absolute or relative path of directory to remove</span>
<span class="sd">        *paths: additional arguments</span>
<span class="sd">            to be joined with ``path``</span>
<span class="sd">            by :func:`os.path.join`</span>
<span class="sd">        follow_symlink: if ``True``</span>
<span class="sd">            and path is a symbolic link,</span>
<span class="sd">            the link and the folder it points to</span>
<span class="sd">            will be removed</span>

<span class="sd">    Raises:</span>
<span class="sd">        NotADirectoryError: if path is not a directory</span>
<span class="sd">        OSError: if ``follow_symlink`` is ``False``</span>
<span class="sd">            and ``path`` is a symbolic link</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; path = audeer.mkdir(&quot;path1&quot;)</span>
<span class="sd">        &gt;&gt;&gt; _ = audeer.mkdir(path, &quot;path2&quot;, &quot;path3&quot;)</span>
<span class="sd">        &gt;&gt;&gt; audeer.list_dir_names(path, basenames=True)</span>
<span class="sd">        [&#39;path2&#39;]</span>
<span class="sd">        &gt;&gt;&gt; audeer.rmdir(path, &quot;path2&quot;)</span>
<span class="sd">        &gt;&gt;&gt; audeer.list_dir_names(path)</span>
<span class="sd">        []</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">safe_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="o">*</span><span class="n">paths</span><span class="p">,</span> <span class="n">follow_symlink</span><span class="o">=</span><span class="n">follow_symlink</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
        <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></div>


<div class="viewcode-block" id="script_dir"><a class="viewcode-back" href="../../../api/audeer.script_dir.html#audeer.script_dir">[docs]</a><span class="k">def</span><span class="w"> </span><span class="nf">script_dir</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Folder in which caller of this function is located.</span>

<span class="sd">    When called from a file,</span>
<span class="sd">    it returns the directory,</span>
<span class="sd">    in which the file is stored.</span>
<span class="sd">    When called in an interactive session,</span>
<span class="sd">    it returns the current working directory</span>
<span class="sd">    of the interactive session.</span>

<span class="sd">    Returns:</span>
<span class="sd">        current directory of caller</span>

<span class="sd">    Examples:</span>
<span class="sd">        .. skip: next if(platform.system() == &quot;Windows&quot;)</span>

<span class="sd">        &gt;&gt;&gt; audeer.script_dir()  # location of this file</span>
<span class="sd">        &#39;...audeer/core&#39;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Returning the script dir is usually done with</span>
    <span class="c1"># `os.path.dirname(os.path.realpath(__file__))`,</span>
    <span class="c1"># see https://stackoverflow.com/a/5137509.</span>
    <span class="c1"># We cannot use `__file__` here,</span>
    <span class="c1"># as this would always point to this file (`io.py`).</span>
    <span class="c1"># Instead we find the script</span>
    <span class="c1"># of the caller of `audeer.script_dir()`,</span>
    <span class="c1"># see https://stackoverflow.com/a/37792573</span>
    <span class="n">caller</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">filename</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">caller</span><span class="p">))</span></div>


<div class="viewcode-block" id="touch"><a class="viewcode-back" href="../../../api/audeer.touch.html#audeer.touch">[docs]</a><span class="k">def</span><span class="w"> </span><span class="nf">touch</span><span class="p">(</span>
    <span class="n">path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">bytes</span><span class="p">,</span>
    <span class="o">*</span><span class="n">paths</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="nb">bytes</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create an empty file.</span>

<span class="sd">    If the file exists already</span>
<span class="sd">    it&#39;s access and modification times</span>
<span class="sd">    are updated.</span>

<span class="sd">    Args:</span>
<span class="sd">        path: path to file</span>
<span class="sd">        *paths: additional arguments</span>
<span class="sd">            to be joined with ``path``</span>
<span class="sd">            by :func:`os.path.join`</span>

<span class="sd">    Returns:</span>
<span class="sd">        expanded path to file</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; path = audeer.touch(&quot;file.txt&quot;)</span>
<span class="sd">        &gt;&gt;&gt; os.path.basename(path)</span>
<span class="sd">        &#39;file.txt&#39;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">safe_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="o">*</span><span class="n">paths</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">utime</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">path</span></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div>
    <p>
        
        
        
          Built with <a href="https://www.sphinx-doc.org">Sphinx</a> on 2025/06/06 using the <a href="https://github.com/audeering/sphinx-audeering-theme/">audEERING theme</a>
        
    </p>
  </div>

  <div role="contentinfo">
    <p>
        
      &copy; audEERING GmbH
    </p>
  </div> 

</footer>
        </div>
      </div>

    </section>

  </div>
  



  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/sphinx_highlight.js"></script>
        <script src="../../../_static/clipboard.min.js"></script>
        <script src="../../../_static/copybutton.js"></script>
    

  

  <script type="text/javascript" src="../../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>