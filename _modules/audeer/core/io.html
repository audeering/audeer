

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>audeer.core.io &mdash; audeer Documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../../_static/favicon.png"/>
  
  
  

  

  
  
    

  
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/audeering.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/copybutton.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    
  

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          <a href="../../../index.html">
          
            <img src="../../../_static/images/audeering.png" class="logo" alt="audEERING"/>
          
          
            <span> audeer</span>
          
          </a>

          
            
            
              <div class="version">
                v1.20.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../usage.html">Usage</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../api/audeer.html">audeer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../genindex.html">Index</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../changelog.html">Changelog</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">audeer</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../index.html">Module code</a> &raquo;</li>
      <li>audeer.core.io</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for audeer.core.io</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">errno</span>
<span class="kn">import</span> <span class="nn">fnmatch</span>
<span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">itertools</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">platform</span>
<span class="kn">import</span> <span class="nn">shutil</span>
<span class="kn">import</span> <span class="nn">tarfile</span>
<span class="kn">import</span> <span class="nn">typing</span>
<span class="kn">import</span> <span class="nn">urllib.request</span>
<span class="kn">import</span> <span class="nn">zipfile</span>

<span class="kn">from</span> <span class="nn">audeer.core.path</span> <span class="kn">import</span> <span class="n">path</span> <span class="k">as</span> <span class="n">safe_path</span>
<span class="kn">from</span> <span class="nn">audeer.core.tqdm</span> <span class="kn">import</span> <span class="n">format_display_message</span>
<span class="kn">from</span> <span class="nn">audeer.core.tqdm</span> <span class="kn">import</span> <span class="n">progress_bar</span>
<span class="kn">from</span> <span class="nn">audeer.core.utils</span> <span class="kn">import</span> <span class="n">to_list</span>


<span class="c1"># Exclude common_directory example from doctest</span>
<span class="c1"># on Windows and MacOS</span>
<span class="c1"># (which adds /System/Volumes/Data in front in the Github runner)</span>
<span class="c1"># as it outputs a path in Linux syntax in the example</span>
<span class="k">if</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Darwin&#39;</span><span class="p">,</span> <span class="s1">&#39;Windows&#39;</span><span class="p">]:</span>  <span class="c1"># pragma: no cover</span>
    <span class="n">__doctest_skip__</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;common_directory&#39;</span><span class="p">,</span>
        <span class="s1">&#39;list_dir_names&#39;</span><span class="p">,</span>
        <span class="s1">&#39;list_file_names&#39;</span><span class="p">,</span>
    <span class="p">]</span>


<div class="viewcode-block" id="basename_wo_ext"><a class="viewcode-back" href="../../../api/audeer.basename_wo_ext.html#audeer.basename_wo_ext">[docs]</a><span class="k">def</span> <span class="nf">basename_wo_ext</span><span class="p">(</span>
        <span class="n">path</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">],</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">ext</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;File basename without file extension.</span>

<span class="sd">    Args:</span>
<span class="sd">        path: file or directory name</span>
<span class="sd">        ext: explicit extension to be removed</span>

<span class="sd">    Returns:</span>
<span class="sd">        basename of directory or file without extension</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; path = &#39;/test/file.wav&#39;</span>
<span class="sd">        &gt;&gt;&gt; basename_wo_ext(path)</span>
<span class="sd">        &#39;file&#39;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">safe_path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ext</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ext</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">):</span>
            <span class="n">ext</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">ext</span>  <span class="c1"># &#39;mp3&#39; =&gt; &#39;.mp3&#39;</span>
        <span class="k">if</span> <span class="n">path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">ext</span><span class="p">):</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">path</span><span class="p">[:</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">ext</span><span class="p">)]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">path</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">path</span></div>


<div class="viewcode-block" id="common_directory"><a class="viewcode-back" href="../../../api/audeer.common_directory.html#audeer.common_directory">[docs]</a><span class="k">def</span> <span class="nf">common_directory</span><span class="p">(</span>
    <span class="n">dirs</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">sep</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">sep</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Find common directory path.</span>

<span class="sd">    Args:</span>
<span class="sd">        dirs: list of directories</span>
<span class="sd">        sep: path separator</span>

<span class="sd">    Returns:</span>
<span class="sd">        part of the directory tree that is common to all the directories</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; paths = [</span>
<span class="sd">        ...     &#39;/home/user1/tmp/coverage/test&#39;,</span>
<span class="sd">        ...     &#39;/home/user1/tmp/covert/operator&#39;,</span>
<span class="sd">        ...     &#39;/home/user1/tmp/coven/members&#39;,</span>
<span class="sd">        ... ]</span>
<span class="sd">        &gt;&gt;&gt; common_directory(paths)</span>
<span class="sd">        &#39;/home/user1/tmp&#39;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">all_names_equal</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">all</span><span class="p">(</span><span class="n">n</span> <span class="o">==</span> <span class="n">name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">name</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>

    <span class="n">dirs</span> <span class="o">=</span> <span class="p">[</span><span class="n">safe_path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">dirs</span><span class="p">]</span>
    <span class="n">by_directory_levels</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">dirs</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">takewhile</span><span class="p">(</span>
        <span class="n">all_names_equal</span><span class="p">,</span> <span class="n">by_directory_levels</span><span class="p">,</span>
    <span class="p">))</span></div>


<div class="viewcode-block" id="create_archive"><a class="viewcode-back" href="../../../api/audeer.create_archive.html#audeer.create_archive">[docs]</a><span class="k">def</span> <span class="nf">create_archive</span><span class="p">(</span>
        <span class="n">root</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">files</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]],</span>
        <span class="n">archive</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Create ZIP or TAR.GZ archive.</span>

<span class="sd">    If a list with ``files`` is provided,</span>
<span class="sd">    only those files will be included to the archive.</span>
<span class="sd">    In that case the files are added in the given order,</span>
<span class="sd">    which may have an influence on the checksum of the archive.</span>

<span class="sd">    If ``files`` is set to ``None``,</span>
<span class="sd">    all files below ``root`` will be added in sorted order.</span>
<span class="sd">    This includes hidden files and files from sub-folders,</span>
<span class="sd">    but not empty folders.</span>

<span class="sd">    Args:</span>
<span class="sd">        root: path to root folder of archive.</span>
<span class="sd">            Only files below ``root`` can be included</span>
<span class="sd">            and will be stored relative to ``root``</span>
<span class="sd">        files: files that will be included in the archive.</span>
<span class="sd">            Absolute and relative file paths are possible,</span>
<span class="sd">            as long as the files are below ``root``.</span>
<span class="sd">            If set to ``None``</span>
<span class="sd">            all files below ``root``</span>
<span class="sd">            will be added to the archive</span>
<span class="sd">        archive: path to archive file.</span>
<span class="sd">            The type of the archive</span>
<span class="sd">            is determined from its file extension</span>
<span class="sd">        verbose: if ``True`` a progress bar is shown</span>

<span class="sd">    Raises:</span>
<span class="sd">        FileNotFoundError: if ``root`` or a file in ``files`` is not found</span>
<span class="sd">        NotADirectoryError: if ``root`` is not a directory</span>
<span class="sd">        RuntimeError: if archive does not end with ``zip`` or ``tar.gz``</span>
<span class="sd">            or a file in ``files`` is not below ``root``</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; _ = touch(&#39;a.txt&#39;)</span>
<span class="sd">        &gt;&gt;&gt; _ = touch(&#39;b.txt&#39;)</span>
<span class="sd">        &gt;&gt;&gt; create_archive(&#39;.&#39;, None, &#39;archive.zip&#39;)</span>
<span class="sd">        &gt;&gt;&gt; extract_archive(&#39;archive.zip&#39;, &#39;.&#39;)</span>
<span class="sd">        [&#39;a.txt&#39;, &#39;b.txt&#39;]</span>
<span class="sd">        &gt;&gt;&gt; create_archive(&#39;.&#39;, [&#39;a.txt&#39;], &#39;archive.tar.gz&#39;)</span>
<span class="sd">        &gt;&gt;&gt; extract_archive(&#39;archive.tar.gz&#39;, &#39;.&#39;)</span>
<span class="sd">        [&#39;a.txt&#39;]</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">root</span> <span class="o">=</span> <span class="n">safe_path</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
    <span class="n">archive</span> <span class="o">=</span> <span class="n">safe_path</span><span class="p">(</span><span class="n">archive</span><span class="p">)</span>
    <span class="n">mkdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">archive</span><span class="p">))</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">root</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span>
            <span class="n">errno</span><span class="o">.</span><span class="n">ENOENT</span><span class="p">,</span>
            <span class="n">os</span><span class="o">.</span><span class="n">strerror</span><span class="p">(</span><span class="n">errno</span><span class="o">.</span><span class="n">ENOENT</span><span class="p">),</span>
            <span class="n">root</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">root</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotADirectoryError</span><span class="p">(</span>
            <span class="n">errno</span><span class="o">.</span><span class="n">ENOTDIR</span><span class="p">,</span>
            <span class="n">os</span><span class="o">.</span><span class="n">strerror</span><span class="p">(</span><span class="n">errno</span><span class="o">.</span><span class="n">ENOTDIR</span><span class="p">),</span>
            <span class="n">root</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">files</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

        <span class="n">files</span> <span class="o">=</span> <span class="n">list_file_names</span><span class="p">(</span>
            <span class="n">root</span><span class="p">,</span>
            <span class="n">basenames</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">hidden</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>

        <span class="n">files_org</span> <span class="o">=</span> <span class="n">to_list</span><span class="p">(</span><span class="n">files</span><span class="p">)</span>
        <span class="n">files</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files_org</span><span class="p">:</span>

            <span class="c1"># convert to absolute path</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isabs</span><span class="p">(</span><span class="n">file</span><span class="p">):</span>
                <span class="n">path</span> <span class="o">=</span> <span class="n">safe_path</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">path</span> <span class="o">=</span> <span class="n">safe_path</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

            <span class="c1"># file is below root</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">path</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">root</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Only files below &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">root</span><span class="si">}</span><span class="s2">&#39; &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;can be included. &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;This is not the case with &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
                <span class="p">)</span>

            <span class="c1"># file exists</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span>
                    <span class="n">errno</span><span class="o">.</span><span class="n">ENOENT</span><span class="p">,</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">strerror</span><span class="p">(</span><span class="n">errno</span><span class="o">.</span><span class="n">ENOENT</span><span class="p">),</span>
                    <span class="n">file</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="c1"># convert to relative path</span>
            <span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">path</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:])</span>

    <span class="c1"># Progress bar arguments</span>
    <span class="n">desc</span> <span class="o">=</span> <span class="n">format_display_message</span><span class="p">(</span>
        <span class="sa">f</span><span class="s1">&#39;Create </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">archive</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
        <span class="n">pbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">disable</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">verbose</span>

    <span class="k">if</span> <span class="n">archive</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;zip&#39;</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">archive</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZIP_DEFLATED</span><span class="p">)</span> <span class="k">as</span> <span class="n">zf</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">progress_bar</span><span class="p">(</span><span class="n">files</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">desc</span><span class="p">,</span> <span class="n">disable</span><span class="o">=</span><span class="n">disable</span><span class="p">):</span>
                <span class="n">full_file</span> <span class="o">=</span> <span class="n">safe_path</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
                <span class="n">zf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">full_file</span><span class="p">,</span> <span class="n">arcname</span><span class="o">=</span><span class="n">file</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">archive</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;tar.gz&#39;</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">archive</span><span class="p">,</span> <span class="s1">&#39;w:gz&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">tf</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">progress_bar</span><span class="p">(</span><span class="n">files</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">desc</span><span class="p">,</span> <span class="n">disable</span><span class="o">=</span><span class="n">disable</span><span class="p">):</span>
                <span class="n">full_file</span> <span class="o">=</span> <span class="n">safe_path</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
                <span class="n">tf</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">full_file</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;You can only create a ZIP or TAR.GZ archive, &#39;</span>
            <span class="sa">f</span><span class="s1">&#39;not </span><span class="si">{</span><span class="n">archive</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="download_url"><a class="viewcode-back" href="../../../api/audeer.download_url.html#audeer.download_url">[docs]</a><span class="k">def</span> <span class="nf">download_url</span><span class="p">(</span>
        <span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">destination</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">force_download</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Download URL to destination.</span>

<span class="sd">    Args:</span>
<span class="sd">        url: URL of file to download</span>
<span class="sd">        destination: file or folder to store file locally</span>
<span class="sd">        force_download: if ``True`` forces the artifact to be downloaded</span>
<span class="sd">            even if it exists locally already</span>
<span class="sd">        verbose: if ``True`` a progress bar is shown</span>

<span class="sd">    Returns:</span>
<span class="sd">        path of locally stored file</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; dst = download_url(&#39;https://audeering.github.io/audeer/_static/favicon.png&#39;, &#39;.&#39;)</span>
<span class="sd">        &gt;&gt;&gt; os.path.basename(dst)</span>
<span class="sd">        &#39;favicon.png&#39;</span>

<span class="sd">    &quot;&quot;&quot;</span>  <span class="c1"># noqa: E501</span>
    <span class="n">destination</span> <span class="o">=</span> <span class="n">safe_path</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">destination</span><span class="p">):</span>
        <span class="n">destination</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">destination</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">url</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">force_download</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">destination</span>

    <span class="k">with</span> <span class="n">progress_bar</span><span class="p">(</span>
            <span class="n">disable</span><span class="o">=</span><span class="ow">not</span> <span class="n">verbose</span><span class="p">,</span>
            <span class="n">desc</span><span class="o">=</span><span class="n">format_display_message</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Downloading </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">pbar</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="p">)</span> <span class="k">as</span> <span class="n">pbar</span><span class="p">:</span>

        <span class="k">def</span> <span class="nf">bar_update</span><span class="p">(</span><span class="n">block_num</span><span class="p">,</span> <span class="n">block_size</span><span class="p">,</span> <span class="n">total_size</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">pbar</span><span class="o">.</span><span class="n">total</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">total_size</span><span class="p">:</span>
                <span class="n">pbar</span><span class="o">.</span><span class="n">total</span> <span class="o">=</span> <span class="n">total_size</span>
            <span class="n">pbar</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">block_size</span><span class="p">)</span>

        <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">destination</span><span class="p">,</span> <span class="n">reporthook</span><span class="o">=</span><span class="n">bar_update</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">destination</span></div>


<div class="viewcode-block" id="extract_archive"><a class="viewcode-back" href="../../../api/audeer.extract_archive.html#audeer.extract_archive">[docs]</a><span class="k">def</span> <span class="nf">extract_archive</span><span class="p">(</span>
        <span class="n">archive</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">destination</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">keep_archive</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Extract ZIP or TAR.GZ file.</span>

<span class="sd">    Args:</span>
<span class="sd">        archive: path to ZIP or TAR.GZ file</span>
<span class="sd">        destination: folder where the files will be extracted.</span>
<span class="sd">            If the folder does not exists,</span>
<span class="sd">            it will be created</span>
<span class="sd">        keep_archive: if ``False`` delete archive file after extraction</span>
<span class="sd">        verbose: if ``True`` a progress bar is shown</span>

<span class="sd">    Returns:</span>
<span class="sd">        paths of extracted files relative to ``destintation``</span>
<span class="sd">        in order they were added to the archive</span>

<span class="sd">    Raises:</span>
<span class="sd">        FileNotFoundError: if ``archive`` is not found</span>
<span class="sd">        IsADirectoryError: if ``archive`` is a directory</span>
<span class="sd">        NotADirectoryError: if ``destination`` is not a directory</span>
<span class="sd">        RuntimeError: if ``archive`` is not a ZIP or TAR.GZ file</span>
<span class="sd">        RuntimeError: if ``archive`` is malformed</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; _ = touch(&#39;a.txt&#39;)</span>
<span class="sd">        &gt;&gt;&gt; create_archive(&#39;.&#39;, None, &#39;archive.zip&#39;)</span>
<span class="sd">        &gt;&gt;&gt; extract_archive(&#39;archive.zip&#39;, &#39;.&#39;)</span>
<span class="sd">        [&#39;a.txt&#39;]</span>
<span class="sd">        &gt;&gt;&gt; extract_archive(&#39;archive.zip&#39;, &#39;sub&#39;)</span>
<span class="sd">        [&#39;a.txt&#39;]</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">archive</span> <span class="o">=</span> <span class="n">safe_path</span><span class="p">(</span><span class="n">archive</span><span class="p">)</span>
    <span class="n">destination</span> <span class="o">=</span> <span class="n">safe_path</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">archive</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span>
            <span class="n">errno</span><span class="o">.</span><span class="n">ENOENT</span><span class="p">,</span>
            <span class="n">os</span><span class="o">.</span><span class="n">strerror</span><span class="p">(</span><span class="n">errno</span><span class="o">.</span><span class="n">ENOENT</span><span class="p">),</span>
            <span class="n">archive</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">archive</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">IsADirectoryError</span><span class="p">(</span>
            <span class="n">errno</span><span class="o">.</span><span class="n">EISDIR</span><span class="p">,</span>
            <span class="n">os</span><span class="o">.</span><span class="n">strerror</span><span class="p">(</span><span class="n">errno</span><span class="o">.</span><span class="n">EISDIR</span><span class="p">),</span>
            <span class="n">archive</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">destination</span><span class="p">):</span>
        <span class="n">destination_created</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">mkdir</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span>
        <span class="n">destination_created</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">destination</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotADirectoryError</span><span class="p">(</span>
            <span class="n">errno</span><span class="o">.</span><span class="n">ENOTDIR</span><span class="p">,</span>
            <span class="n">os</span><span class="o">.</span><span class="n">strerror</span><span class="p">(</span><span class="n">errno</span><span class="o">.</span><span class="n">ENOTDIR</span><span class="p">),</span>
            <span class="n">destination</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1"># Progress bar arguments</span>
    <span class="n">desc</span> <span class="o">=</span> <span class="n">format_display_message</span><span class="p">(</span>
        <span class="sa">f</span><span class="s1">&#39;Extract </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">archive</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
        <span class="n">pbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">disable</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">verbose</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">archive</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;zip&#39;</span><span class="p">):</span>
            <span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">archive</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">zf</span><span class="p">:</span>
                <span class="n">members</span> <span class="o">=</span> <span class="n">zf</span><span class="o">.</span><span class="n">infolist</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">member</span> <span class="ow">in</span> <span class="n">progress_bar</span><span class="p">(</span>
                    <span class="n">members</span><span class="p">,</span>
                    <span class="n">desc</span><span class="o">=</span><span class="n">desc</span><span class="p">,</span>
                    <span class="n">disable</span><span class="o">=</span><span class="n">disable</span><span class="p">,</span>
                <span class="p">):</span>
                    <span class="n">zf</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">member</span><span class="p">,</span> <span class="n">destination</span><span class="p">)</span>
                <span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="n">m</span><span class="o">.</span><span class="n">filename</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">members</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">archive</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;tar.gz&#39;</span><span class="p">):</span>
            <span class="k">with</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">archive</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">tf</span><span class="p">:</span>
                <span class="n">members</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">getmembers</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">member</span> <span class="ow">in</span> <span class="n">progress_bar</span><span class="p">(</span>
                    <span class="n">members</span><span class="p">,</span>
                    <span class="n">desc</span><span class="o">=</span><span class="n">desc</span><span class="p">,</span>
                    <span class="n">disable</span><span class="o">=</span><span class="n">disable</span><span class="p">,</span>
                <span class="p">):</span>
                    <span class="n">tf</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">member</span><span class="p">,</span> <span class="n">destination</span><span class="p">,</span> <span class="n">numeric_owner</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="n">m</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">members</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s1">&#39;You can only extract ZIP and TAR.GZ files, &#39;</span>
                <span class="sa">f</span><span class="s1">&#39;not </span><span class="si">{</span><span class="n">archive</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="p">)</span>
    <span class="k">except</span> <span class="p">(</span><span class="ne">EOFError</span><span class="p">,</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">BadZipFile</span><span class="p">,</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">ReadError</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Broken archive: </span><span class="si">{</span><span class="n">archive</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">except</span> <span class="p">(</span><span class="ne">KeyboardInterrupt</span><span class="p">,</span> <span class="ne">Exception</span><span class="p">):</span>  <span class="c1"># pragma: no cover</span>
        <span class="c1"># Clean up broken extraction files</span>
        <span class="k">if</span> <span class="n">destination_created</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">destination</span><span class="p">):</span>
                <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span>
        <span class="k">raise</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">keep_archive</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">archive</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;nt&#39;</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
        <span class="c1"># replace &#39;/&#39; with &#39;\&#39; on Windows</span>
        <span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="n">file</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">sep</span><span class="p">)</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">files</span></div>


<div class="viewcode-block" id="extract_archives"><a class="viewcode-back" href="../../../api/audeer.extract_archives.html#audeer.extract_archives">[docs]</a><span class="k">def</span> <span class="nf">extract_archives</span><span class="p">(</span>
        <span class="n">archives</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">destination</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">keep_archive</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Extract multiple ZIP or TAR.GZ archives at once.</span>

<span class="sd">    Args:</span>
<span class="sd">        archives: paths of ZIP or TAR.GZ files</span>
<span class="sd">        destination: folder where the files will be extracted.</span>
<span class="sd">            If the folder does not exists,</span>
<span class="sd">            it will be created</span>
<span class="sd">        keep_archive: if ``False`` delete archive files after extraction</span>
<span class="sd">        verbose: if ``True`` a progress bar is shown</span>

<span class="sd">    Returns:</span>
<span class="sd">        paths of extracted files relative to ``destintation``</span>
<span class="sd">        in order they were added to the archives</span>

<span class="sd">    Raises:</span>
<span class="sd">        FileNotFoundError: if an archive is not found</span>
<span class="sd">        IsADirectoryError: if an archive is a directory</span>
<span class="sd">        NotADirectoryError: if ``destination`` is not a directory</span>
<span class="sd">        RuntimeError: if an archive is not a ZIP or TAR.GZ file</span>
<span class="sd">        RuntimeError: if an archive file is malformed</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; _ = touch(&#39;a.txt&#39;)</span>
<span class="sd">        &gt;&gt;&gt; create_archive(&#39;.&#39;, [&#39;a.txt&#39;], &#39;archive.zip&#39;)</span>
<span class="sd">        &gt;&gt;&gt; _ = touch(&#39;b.txt&#39;)</span>
<span class="sd">        &gt;&gt;&gt; create_archive(&#39;.&#39;, [&#39;b.txt&#39;], &#39;archive.tar.gz&#39;)</span>
<span class="sd">        &gt;&gt;&gt; extract_archives([&#39;archive.zip&#39;, &#39;archive.tar.gz&#39;], &#39;.&#39;)</span>
<span class="sd">        [&#39;a.txt&#39;, &#39;b.txt&#39;]</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="n">progress_bar</span><span class="p">(</span>
        <span class="n">total</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">archives</span><span class="p">),</span>
        <span class="n">disable</span><span class="o">=</span><span class="ow">not</span> <span class="n">verbose</span><span class="p">,</span>
    <span class="p">)</span> <span class="k">as</span> <span class="n">pbar</span><span class="p">:</span>
        <span class="n">member_names</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">archive</span> <span class="ow">in</span> <span class="n">archives</span><span class="p">:</span>
            <span class="n">desc</span> <span class="o">=</span> <span class="n">format_display_message</span><span class="p">(</span>
                <span class="sa">f</span><span class="s1">&#39;Extract </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">archive</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
                <span class="n">pbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">pbar</span><span class="o">.</span><span class="n">set_description_str</span><span class="p">(</span><span class="n">desc</span><span class="p">)</span>
            <span class="n">pbar</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
            <span class="n">member_names</span> <span class="o">+=</span> <span class="n">extract_archive</span><span class="p">(</span>
                <span class="n">archive</span><span class="p">,</span>
                <span class="n">destination</span><span class="p">,</span>
                <span class="n">keep_archive</span><span class="o">=</span><span class="n">keep_archive</span><span class="p">,</span>
                <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">pbar</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">member_names</span></div>


<div class="viewcode-block" id="file_extension"><a class="viewcode-back" href="../../../api/audeer.file_extension.html#audeer.file_extension">[docs]</a><span class="k">def</span> <span class="nf">file_extension</span><span class="p">(</span>
        <span class="n">path</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;File extension.</span>

<span class="sd">    Args:</span>
<span class="sd">        path: path to file</span>

<span class="sd">    Returns:</span>
<span class="sd">        extension of file without &quot;.&quot;</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; path = &#39;/test/file.wav&#39;</span>
<span class="sd">        &gt;&gt;&gt; file_extension(path)</span>
<span class="sd">        &#39;wav&#39;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">safe_path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">path</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span></div>


<div class="viewcode-block" id="list_dir_names"><a class="viewcode-back" href="../../../api/audeer.list_dir_names.html#audeer.list_dir_names">[docs]</a><span class="k">def</span> <span class="nf">list_dir_names</span><span class="p">(</span>
        <span class="n">path</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">],</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">basenames</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">recursive</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">hidden</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;List of folder names located inside provided path.</span>

<span class="sd">    Args:</span>
<span class="sd">        path: path to directory</span>
<span class="sd">        basenames: if ``True`` return relative path in respect to ``path``</span>
<span class="sd">        recursive: if ``True`` includes subdirectories</span>
<span class="sd">        hidden: if ``True`` includes directories starting with a dot (``.``)</span>

<span class="sd">    Returns:</span>
<span class="sd">        list of paths to directories</span>

<span class="sd">    Raises:</span>
<span class="sd">        NotADirectoryError: if path is not a directory</span>
<span class="sd">        FileNotFoundError: if path does not exists</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; _ = mkdir(&#39;path/a/.b/c&#39;)</span>
<span class="sd">        &gt;&gt;&gt; list_dir_names(</span>
<span class="sd">        ...     &#39;path&#39;,</span>
<span class="sd">        ...     basenames=True,</span>
<span class="sd">        ... )</span>
<span class="sd">        [&#39;a&#39;]</span>
<span class="sd">        &gt;&gt;&gt; list_dir_names(</span>
<span class="sd">        ...     &#39;path&#39;,</span>
<span class="sd">        ...     basenames=True,</span>
<span class="sd">        ...     recursive=True,</span>
<span class="sd">        ... )</span>
<span class="sd">        [&#39;a&#39;, &#39;a/.b&#39;, &#39;a/.b/c&#39;]</span>
<span class="sd">        &gt;&gt;&gt; list_dir_names(</span>
<span class="sd">        ...     &#39;path&#39;,</span>
<span class="sd">        ...     basenames=True,</span>
<span class="sd">        ...     recursive=True,</span>
<span class="sd">        ...     hidden=False,</span>
<span class="sd">        ... )</span>
<span class="sd">        [&#39;a&#39;]</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">safe_path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">helper</span><span class="p">(</span><span class="n">p</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">paths</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span>
        <span class="n">ps</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">p</span><span class="p">)]</span>
        <span class="n">ps</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ps</span> <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">hidden</span><span class="p">:</span>
            <span class="n">ps</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ps</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)]</span>
        <span class="n">paths</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">ps</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ps</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">recursive</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">ps</span><span class="p">:</span>
                <span class="n">helper</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">paths</span><span class="p">)</span>

    <span class="n">paths</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">helper</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">paths</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">basenames</span><span class="p">:</span>
        <span class="n">paths</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">paths</span><span class="p">]</span>

    <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">paths</span><span class="p">)</span></div>


<div class="viewcode-block" id="list_file_names"><a class="viewcode-back" href="../../../api/audeer.list_file_names.html#audeer.list_file_names">[docs]</a><span class="k">def</span> <span class="nf">list_file_names</span><span class="p">(</span>
        <span class="n">path</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">],</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">filetype</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
        <span class="n">basenames</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">recursive</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">hidden</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;List of file names inferred from provided path.</span>

<span class="sd">    Args:</span>
<span class="sd">        path: path to directory,</span>
<span class="sd">            or path to directory plus file matching pattern,</span>
<span class="sd">            e.g. ``&#39;dir/file.txt&#39;``.</span>
<span class="sd">            If ``recursive`` is ``True``</span>
<span class="sd">            returns all files named ``file.txt``</span>
<span class="sd">            from all sub-folders.</span>
<span class="sd">            Besides the filename ``*``, ``?``, ``[seq]``,</span>
<span class="sd">            and ``[!seq]`` can be used as pattern,</span>
<span class="sd">            compare :mod:`fnmatch`</span>
<span class="sd">        filetype: optional consider only this filetype</span>
<span class="sd">        basenames: if ``True`` return relative path in respect to ``path``</span>
<span class="sd">        recursive: if ``True`` includes subdirectories</span>
<span class="sd">        hidden: if ``True`` includes files starting with a dot (``.``)</span>

<span class="sd">    Returns:</span>
<span class="sd">        alphabetically sorted list of path(s) to file(s)</span>

<span class="sd">    Raises:</span>
<span class="sd">        NotADirectoryError: if ``path`` is a directory or file</span>
<span class="sd">            that does not exist,</span>
<span class="sd">            or ``path`` is a pattern</span>
<span class="sd">            and ``os.dirname(path)`` does not exist</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; dir_path = mkdir(&#39;path&#39;)</span>
<span class="sd">        &gt;&gt;&gt; _ = touch(os.path.join(dir_path, &#39;file.wav&#39;))</span>
<span class="sd">        &gt;&gt;&gt; _ = touch(os.path.join(dir_path, &#39;File.wav&#39;))</span>
<span class="sd">        &gt;&gt;&gt; _ = touch(os.path.join(dir_path, &#39;.lock&#39;))</span>
<span class="sd">        &gt;&gt;&gt; sub_dir_path = mkdir(os.path.join(&#39;path&#39;, &#39;sub&#39;))</span>
<span class="sd">        &gt;&gt;&gt; _ = touch(os.path.join(sub_dir_path, &#39;file.ogg&#39;))</span>
<span class="sd">        &gt;&gt;&gt; _ = touch(os.path.join(sub_dir_path, &#39;.lock&#39;))</span>
<span class="sd">        &gt;&gt;&gt; list_file_names(</span>
<span class="sd">        ...     dir_path,</span>
<span class="sd">        ...     basenames=True,</span>
<span class="sd">        ... )</span>
<span class="sd">        [&#39;File.wav&#39;, &#39;file.wav&#39;]</span>
<span class="sd">        &gt;&gt;&gt; list_file_names(</span>
<span class="sd">        ...     dir_path,</span>
<span class="sd">        ...     basenames=True,</span>
<span class="sd">        ...     hidden=True,</span>
<span class="sd">        ... )</span>
<span class="sd">        [&#39;.lock&#39;, &#39;File.wav&#39;, &#39;file.wav&#39;]</span>
<span class="sd">        &gt;&gt;&gt; list_file_names(</span>
<span class="sd">        ...     dir_path,</span>
<span class="sd">        ...     basenames=True,</span>
<span class="sd">        ...     recursive=True,</span>
<span class="sd">        ... )</span>
<span class="sd">        [&#39;File.wav&#39;, &#39;file.wav&#39;, &#39;sub/file.ogg&#39;]</span>
<span class="sd">        &gt;&gt;&gt; list_file_names(</span>
<span class="sd">        ...     dir_path,</span>
<span class="sd">        ...     basenames=True,</span>
<span class="sd">        ...     recursive=True,</span>
<span class="sd">        ...     hidden=True,</span>
<span class="sd">        ... )</span>
<span class="sd">        [&#39;.lock&#39;, &#39;File.wav&#39;, &#39;file.wav&#39;, &#39;sub/.lock&#39;, &#39;sub/file.ogg&#39;]</span>
<span class="sd">        &gt;&gt;&gt; list_file_names(</span>
<span class="sd">        ...     os.path.join(dir_path, &#39;f*&#39;),</span>
<span class="sd">        ...     basenames=True,</span>
<span class="sd">        ...     recursive=True,</span>
<span class="sd">        ...     hidden=True,</span>
<span class="sd">        ... )</span>
<span class="sd">        [&#39;file.wav&#39;, &#39;sub/file.ogg&#39;]</span>
<span class="sd">        &gt;&gt;&gt; list_file_names(</span>
<span class="sd">        ...     os.path.join(dir_path, &#39;[fF]*&#39;),</span>
<span class="sd">        ...     basenames=True,</span>
<span class="sd">        ...     recursive=True,</span>
<span class="sd">        ...     hidden=True,</span>
<span class="sd">        ... )</span>
<span class="sd">        [&#39;File.wav&#39;, &#39;file.wav&#39;, &#39;sub/file.ogg&#39;]</span>
<span class="sd">        &gt;&gt;&gt; list_file_names(</span>
<span class="sd">        ...     os.path.join(dir_path, &#39;[!f]*&#39;),</span>
<span class="sd">        ...     basenames=True,</span>
<span class="sd">        ...     recursive=True,</span>
<span class="sd">        ...     hidden=True,</span>
<span class="sd">        ... )</span>
<span class="sd">        [&#39;.lock&#39;, &#39;File.wav&#39;, &#39;sub/.lock&#39;]</span>
<span class="sd">        &gt;&gt;&gt; list_file_names(</span>
<span class="sd">        ...     os.path.join(dir_path, &#39;f*&#39;),</span>
<span class="sd">        ...     filetype=&#39;ogg&#39;,</span>
<span class="sd">        ...     basenames=True,</span>
<span class="sd">        ...     recursive=True,</span>
<span class="sd">        ...     hidden=True,</span>
<span class="sd">        ... )</span>
<span class="sd">        [&#39;sub/file.ogg&#39;]</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">safe_path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>

        <span class="n">pattern</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">folder</span> <span class="o">=</span> <span class="n">path</span>

    <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">recursive</span><span class="p">:</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">hidden</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">basenames</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">path</span><span class="p">]</span>

    <span class="k">else</span><span class="p">:</span>

        <span class="n">pattern</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="n">folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">folder</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">NotADirectoryError</span><span class="p">(</span><span class="n">folder</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">helper</span><span class="p">(</span><span class="n">p</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">paths</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span>
        <span class="n">ps</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">p</span><span class="p">)]</span>
        <span class="n">folders</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ps</span> <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
        <span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ps</span> <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
        <span class="k">if</span> <span class="n">pattern</span><span class="p">:</span>
            <span class="n">files</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">file</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span>
                <span class="k">if</span> <span class="n">fnmatch</span><span class="o">.</span><span class="n">fnmatch</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">file</span><span class="p">),</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">pattern</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="p">]</span>
        <span class="k">if</span> <span class="n">filetype</span><span class="p">:</span>
            <span class="n">files</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">file</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span>
                <span class="k">if</span> <span class="n">fnmatch</span><span class="o">.</span><span class="n">fnmatch</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">file</span><span class="p">),</span> <span class="sa">f</span><span class="s1">&#39;*</span><span class="si">{</span><span class="n">filetype</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="p">]</span>
        <span class="n">paths</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">files</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">folders</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">recursive</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">folders</span><span class="p">:</span>
                <span class="n">helper</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">paths</span><span class="p">)</span>

    <span class="n">paths</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">helper</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">paths</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">is_pattern</span><span class="p">(</span><span class="n">pattern</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span>
                <span class="s1">&#39;*&#39;</span> <span class="ow">in</span> <span class="n">pattern</span> <span class="ow">or</span>
                <span class="s1">&#39;?&#39;</span> <span class="ow">in</span> <span class="n">pattern</span> <span class="ow">or</span>
                <span class="p">(</span><span class="s1">&#39;[&#39;</span> <span class="ow">in</span> <span class="n">pattern</span> <span class="ow">and</span> <span class="s1">&#39;]&#39;</span> <span class="ow">in</span> <span class="n">pattern</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="c1"># if we have no match,</span>
    <span class="c1"># raise an error unless</span>
    <span class="c1"># 1. path is a folder (i.e. pattern is None)</span>
    <span class="c1"># 2. or we have a valid pattern</span>
    <span class="k">if</span> <span class="p">(</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">paths</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
            <span class="ow">and</span> <span class="n">pattern</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="ow">and</span> <span class="ow">not</span> <span class="n">is_pattern</span><span class="p">(</span><span class="n">pattern</span><span class="p">)</span>
    <span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotADirectoryError</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">hidden</span><span class="p">:</span>
        <span class="n">paths</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">paths</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
        <span class="p">]</span>

    <span class="k">if</span> <span class="n">basenames</span><span class="p">:</span>
        <span class="n">paths</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">folder</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">paths</span><span class="p">]</span>

    <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">paths</span><span class="p">)</span></div>


<div class="viewcode-block" id="mkdir"><a class="viewcode-back" href="../../../api/audeer.mkdir.html#audeer.mkdir">[docs]</a><span class="k">def</span> <span class="nf">mkdir</span><span class="p">(</span>
        <span class="n">path</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">],</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">mode</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mo">0o777</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create directory.</span>

<span class="sd">    Create a directory at the provided path</span>
<span class="sd">    and return the absolute path to the generated directory.</span>
<span class="sd">    If parent directories are missing,</span>
<span class="sd">    they are created as well.</span>
<span class="sd">    If the directory exists already,</span>
<span class="sd">    only its absolute path is returned.</span>

<span class="sd">    On some systems, mode is ignored.</span>
<span class="sd">    Where it is used, the current umask value is first masked out.</span>
<span class="sd">    If bits other than the last 9</span>
<span class="sd">    (i.e. the last 3 digits of the octal representation of the mode)</span>
<span class="sd">    are set,</span>
<span class="sd">    their meaning is platform-dependent.</span>
<span class="sd">    On some platforms, they are ignored</span>
<span class="sd">    and you should call :func:`os.chmod`</span>
<span class="sd">    explicitly to set them.</span>

<span class="sd">    Args:</span>
<span class="sd">        path: absolute or relative path of directory to create</span>
<span class="sd">        mode: set permissions of created folders</span>

<span class="sd">    Returns:</span>
<span class="sd">        absolute path to the created directory</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; p = mkdir(&#39;path1/path2/path3&#39;)</span>
<span class="sd">        &gt;&gt;&gt; os.path.basename(p)</span>
<span class="sd">        &#39;path3&#39;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">safe_path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">path</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">path</span></div>


<div class="viewcode-block" id="md5"><a class="viewcode-back" href="../../../api/audeer.md5.html#audeer.md5">[docs]</a><span class="k">def</span> <span class="nf">md5</span><span class="p">(</span>
        <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">chunk_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8192</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate MD5 checksum of file or folder.</span>

<span class="sd">    If ``path`` is a folder,</span>
<span class="sd">    the checksum is calculated</span>
<span class="sd">    from all files in the folder</span>
<span class="sd">    (including hidden files).</span>
<span class="sd">    The checksum also encodes</span>
<span class="sd">    the (relative) file names,</span>
<span class="sd">    so that renaming files</span>
<span class="sd">    results in a different checksum.</span>
<span class="sd">    However,</span>
<span class="sd">    the calculation is independent of</span>
<span class="sd">    file separator of the operation systems.</span>
<span class="sd">    Empty folders are ignored.</span>

<span class="sd">    Args:</span>
<span class="sd">        path: path to file or folder</span>
<span class="sd">        chunk_size: chunk size in number of bytes</span>

<span class="sd">    Returns:</span>
<span class="sd">        checksum</span>

<span class="sd">    Raises:</span>
<span class="sd">        FileNotFoundError: if ``path`` does not exist</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; path = touch(&#39;file.txt&#39;)</span>
<span class="sd">        &gt;&gt;&gt; md5(path)</span>
<span class="sd">        &#39;d41d8cd98f00b204e9800998ecf8427e&#39;</span>
<span class="sd">        &gt;&gt;&gt; md5(&#39;.&#39;)</span>
<span class="sd">        &#39;3d8e577bddb17db339eae0b3d9bcf180&#39;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">safe_path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="n">hasher</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">()</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span>
            <span class="n">errno</span><span class="o">.</span><span class="n">ENOENT</span><span class="p">,</span>
            <span class="n">os</span><span class="o">.</span><span class="n">strerror</span><span class="p">(</span><span class="n">errno</span><span class="o">.</span><span class="n">ENOENT</span><span class="p">),</span>
            <span class="n">path</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">md5_read_chunk</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">chunk_size</span><span class="p">):</span>
                <span class="n">hasher</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>

        <span class="n">files</span> <span class="o">=</span> <span class="n">list_file_names</span><span class="p">(</span>
            <span class="n">path</span><span class="p">,</span>
            <span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">hidden</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">basenames</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
            <span class="c1"># encode file name that renaming of files</span>
            <span class="c1"># produces different checksum</span>
            <span class="n">hasher</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">sep</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">safe_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">file</span><span class="p">),</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">md5_read_chunk</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">chunk_size</span><span class="p">):</span>
                    <span class="n">hasher</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">hasher</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span></div>


<span class="k">def</span> <span class="nf">md5_read_chunk</span><span class="p">(</span>
        <span class="n">fp</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">IO</span><span class="p">,</span>
        <span class="n">chunk_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8192</span><span class="p">,</span>
<span class="p">):</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">chunk_size</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="k">yield</span> <span class="n">data</span>


<div class="viewcode-block" id="move_file"><a class="viewcode-back" href="../../../api/audeer.move_file.html#audeer.move_file">[docs]</a><span class="k">def</span> <span class="nf">move_file</span><span class="p">(</span>
        <span class="n">src_path</span><span class="p">,</span>
        <span class="n">dst_path</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Move a file independent of operating system.</span>

<span class="sd">    As :func:`os.rename` works differently</span>
<span class="sd">    under Unix and Windows</span>
<span class="sd">    and :func:`shutil.move` can be slow,</span>
<span class="sd">    we use :func:`os.replace`</span>
<span class="sd">    to move the file.</span>

<span class="sd">    Args:</span>
<span class="sd">        src_path: source file path</span>
<span class="sd">        dst_path: destination file path</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; path = mkdir(&#39;folder&#39;)</span>
<span class="sd">        &gt;&gt;&gt; src_path = touch(os.path.join(path, &#39;file1&#39;))</span>
<span class="sd">        &gt;&gt;&gt; dst_path = os.path.join(path, &#39;file2&#39;)</span>
<span class="sd">        &gt;&gt;&gt; move_file(src_path, dst_path)</span>
<span class="sd">        &gt;&gt;&gt; list_file_names(path, basenames=True)</span>
<span class="sd">        [&#39;file2&#39;]</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">os</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">src_path</span><span class="p">,</span> <span class="n">dst_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="replace_file_extension"><a class="viewcode-back" href="../../../api/audeer.replace_file_extension.html#audeer.replace_file_extension">[docs]</a><span class="k">def</span> <span class="nf">replace_file_extension</span><span class="p">(</span>
        <span class="n">path</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">],</span>
        <span class="n">new_extension</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">ext</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Replace file extension.</span>

<span class="sd">    If ``ext`` is ``None``</span>
<span class="sd">    it uses :func:`audeer.file_extension`</span>
<span class="sd">    to identify the current extension</span>
<span class="sd">    and replaces it with ``new_extension``.</span>

<span class="sd">    If ``ext`` is not ``None``</span>
<span class="sd">    but ``path`` ends on a different extension,</span>
<span class="sd">    the original path is returned.</span>

<span class="sd">    Args:</span>
<span class="sd">        path: path to file</span>
<span class="sd">        new_extension: new file extension</span>
<span class="sd">        ext: explicit extension to be removed</span>

<span class="sd">    Returns:</span>
<span class="sd">        path to file with a possibly new extension</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; replace_file_extension(&#39;file.txt&#39;, &#39;rst&#39;)</span>
<span class="sd">        &#39;file.rst&#39;</span>
<span class="sd">        &gt;&gt;&gt; replace_file_extension(&#39;file&#39;, &#39;rst&#39;)</span>
<span class="sd">        &#39;file.rst&#39;</span>
<span class="sd">        &gt;&gt;&gt; replace_file_extension(&#39;file.txt&#39;, &#39;&#39;)</span>
<span class="sd">        &#39;file&#39;</span>
<span class="sd">        &gt;&gt;&gt; replace_file_extension(&#39;file.tar.gz&#39;, &#39;zip&#39;, ext=&#39;tar.gz&#39;)</span>
<span class="sd">        &#39;file.zip&#39;</span>
<span class="sd">        &gt;&gt;&gt; replace_file_extension(&#39;file.zip&#39;, &#39;rst&#39;, ext=&#39;txt&#39;)</span>
<span class="sd">        &#39;file.zip&#39;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">ext</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ext</span> <span class="o">=</span> <span class="n">file_extension</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

    <span class="c1"># &#39;.mp3&#39; =&gt; &#39;mp3&#39;</span>
    <span class="k">if</span> <span class="n">ext</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">):</span>
        <span class="n">ext</span> <span class="o">=</span> <span class="n">ext</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
    <span class="k">if</span> <span class="n">new_extension</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">):</span>
        <span class="n">new_extension</span> <span class="o">=</span> <span class="n">new_extension</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

    <span class="k">if</span> <span class="n">ext</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;.</span><span class="si">{</span><span class="n">ext</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">path</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">path</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">path</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">ext</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">new_extension</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="n">ext</span><span class="p">:</span>
        <span class="n">path</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s1">.</span><span class="si">{</span><span class="n">new_extension</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="n">new_extension</span><span class="p">:</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">path</span><span class="p">[:</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">ext</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">path</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">path</span><span class="p">[:</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">ext</span><span class="p">)]</span><span class="si">}{</span><span class="n">new_extension</span><span class="si">}</span><span class="s1">&#39;</span>

    <span class="k">return</span> <span class="n">path</span></div>


<div class="viewcode-block" id="rmdir"><a class="viewcode-back" href="../../../api/audeer.rmdir.html#audeer.rmdir">[docs]</a><span class="k">def</span> <span class="nf">rmdir</span><span class="p">(</span>
        <span class="n">path</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">],</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Remove directory.</span>

<span class="sd">    Remove the directory</span>
<span class="sd">    and all its content</span>
<span class="sd">    if the directory exists.</span>

<span class="sd">    Args:</span>
<span class="sd">        path: absolute or relative path of directory to remove</span>

<span class="sd">    Raises:</span>
<span class="sd">        NotADirectoryError: if path is not a directory</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; _ = mkdir(&#39;path1/path2/path3&#39;)</span>
<span class="sd">        &gt;&gt;&gt; list_dir_names(&#39;path1&#39;, basenames=True)</span>
<span class="sd">        [&#39;path2&#39;]</span>
<span class="sd">        &gt;&gt;&gt; rmdir(&#39;path1/path2&#39;)</span>
<span class="sd">        &gt;&gt;&gt; list_dir_names(&#39;path1&#39;)</span>
<span class="sd">        []</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">safe_path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
        <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></div>


<div class="viewcode-block" id="touch"><a class="viewcode-back" href="../../../api/audeer.touch.html#audeer.touch">[docs]</a><span class="k">def</span> <span class="nf">touch</span><span class="p">(</span>
        <span class="n">path</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create an empty file.</span>

<span class="sd">    If the file exists already</span>
<span class="sd">    it&#39;s access and modification times</span>
<span class="sd">    are updated.</span>

<span class="sd">    Args:</span>
<span class="sd">        path: path to file</span>

<span class="sd">    Returns:</span>
<span class="sd">        expanded path to file</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; path = touch(&#39;file.txt&#39;)</span>
<span class="sd">        &gt;&gt;&gt; os.path.basename(path)</span>
<span class="sd">        &#39;file.txt&#39;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">safe_path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">utime</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">path</span></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div>
    <p>
        
        
        
          Built with <a href="https://www.sphinx-doc.org/en/master/">Sphinx</a> on 2023/11/28 using the <a href="https://github.com/audeering/sphinx-audeering-theme/">audEERING theme</a>
        
    </p>
  </div>

  <div role="contentinfo">
    <p>
        
      &copy; audEERING GmbH
    </p>
  </div> 

</footer>
        </div>
      </div>

    </section>

  </div>
  



  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/sphinx_highlight.js"></script>
        <script src="../../../_static/clipboard.min.js"></script>
        <script src="../../../_static/copybutton.js"></script>
    

  

  <script type="text/javascript" src="../../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>